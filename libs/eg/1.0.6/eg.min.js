var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);n.prototype=t.prototype,e.prototype=new n},__awaiter=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(t){o(t)}}function s(e){try{u(r["throw"](e))}catch(t){o(t)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(a=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(a=u.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(r){n=[6,r],o=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,a,s,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},eg;!function(e){var t=function(){function t(){}return t.init=function(t){e.Config.stage=t.stage,e.Config.STAGE_W=t.stage.stageWidth,e.Config.STAGE_H=t.stage.stageHeight,e.log("eg.Config.STAGE_W|H:"+e.Config.STAGE_W+"|"+e.Config.STAGE_H)},t.isWxgame=function(){return"wxgame"==egret.Capabilities.runtimeType},t.isAutoUploadPageData=!0,t.wxgameCache=!0,t.showLog=!1,t}();e.Config=t,__reflect(t.prototype,"eg.Config")}(eg||(eg={}));var eg;!function(e){var t=function(){function e(){}return e}();e.WXSoundProcessor=t,__reflect(t.prototype,"eg.WXSoundProcessor")}(eg||(eg={}));var eg;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.version="1.0.6",e}return __extends(n,t),n.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(e){}),egret.lifecycle.onPause=function(){egret.ticker.pause(),e.log("onPause")},egret.lifecycle.onResume=function(){egret.ticker.resume(),e.log("onResume")},this.runGame()["catch"](function(t){e.log("error:"+t.toString())})},n.prototype.initBefore=function(){e.log("initBefore")},n.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return e.log("------------------框架初始化开始-------------------------"),this.initBefore(),[4,this.initEg()];case 1:return t.sent(),[4,this.loadConfig(this.configUrl,this.resourceRoot)];case 2:return t.sent(),[4,this.loadRes()];case 3:return t.sent(),this.loadResAfter(),e.log("------------------框架初始化结束---------------------------"),this.createGameScene(),[2]}})})},n.prototype.loadRes=function(){var t=this;return new Promise(function(n,r){return __awaiter(t,void 0,void 0,function(){function t(){e.Loading.Instance.hide(),n()}function r(t){e.Loading.Instance.progress(t.itemsLoaded,t.itemsTotal)}function i(){e.log("loadGroup preload onError")}var o;return __generator(this,function(n){return e.Loading.Instance.show(),e.QueueLoader.Instance.loadGroup(this.preloadName,-1,this,t,r,i),o=this,[2]})})})},n.prototype.loadResAfter=function(){e.log("loadResAfter")},Object.defineProperty(n.prototype,"configUrl",{get:function(){var t=void 0==window.resVersion?Date.now():window.resVersion,n="resource/default.res.json";return e.Config.isWxgame()||(n+="?v="+t),n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"resourceRoot",{get:function(){return"resource/"},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"preloadName",{get:function(){return"preload"},enumerable:!0,configurable:!0}),n.prototype.initEg=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return this.log(),this.customEXMLProcessor(),this.initAssetAdapter(),e.isDebug()&&this.initTheme(),this.soundException(),e.Config.init(this),e.UILayer.Instance.init(this.stage),[2]})})},n.prototype.wxgame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return e.Config.isWxgame()?[4,e.WXCacheManager.Instance.init()]:[3,2];case 1:t.sent(),window.eg=e,t.label=2;case 2:return[2]}})})},n.prototype.initAssetAdapter=function(){var t=new e.AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t)},n.prototype.initTheme=function(){egret.registerImplementation("eui.IThemeAdapter",new e.ThemeAdapter);var t=new eui.Theme("",this.stage);t.mapSkin("eui.Button","resource/eui_skins/ButtonSkin.exml"),t.mapSkin("eui.CheckBox","resource/eui_skins/CheckBoxSkin.exml"),t.mapSkin("eui.HScrollBar","resource/eui_skins/HScrollBarSkin.exml"),t.mapSkin("eui.HSlider","resource/eui_skins/HSliderSkin.exml"),t.mapSkin("eui.Panel","resource/eui_skins/PanelSkin.exml"),t.mapSkin("eui.TextInput","resource/eui_skins/TextInputSkin.exml"),t.mapSkin("eui.ProgressBar","resource/eui_skins/ProgressBarSkin.exml"),t.mapSkin("eui.RadioButton","resource/eui_skins/RadioButtonSkin.exml"),t.mapSkin("eui.Scroller","resource/eui_skins/ScrollerSkin.exml"),t.mapSkin("eui.ToggleSwitch","resource/eui_skins/ToggleSwitchSkin.exml"),t.mapSkin("eui.VScrollBar","resource/eui_skins/VScrollBarSkin.exml"),t.mapSkin("eui.VSlider","resource/eui_skins/VSliderSkin.exml"),t.mapSkin("eui.ItemRenderer","resource/eui_skins/ItemRendererSkin.exml")},n.prototype.log=function(){e.log("框架代码版本号:"+this.version),e.log("engineVersion:"+egret.Capabilities.engineVersion),e.log("renderMode:"+egret.Capabilities.renderMode),e.log("runtimeType:"+egret.Capabilities.runtimeType),e.log("os:"+egret.Capabilities.os),e.log("isMobile:"+egret.Capabilities.isMobile),e.log("boundingClientWidth:"+egret.Capabilities.boundingClientWidth),e.log("boundingClientHeight:"+egret.Capabilities.boundingClientHeight),e.log("navigator.userAgent:"+window.navigator.userAgent),e.log("window.screen width|height:"+window.screen.width+"|"+window.screen.height),e.log("document.body.clientWidth|document.body.clientHeight"+document.body.clientWidth+"|"+document.body.clientHeight)},n.prototype.loadConfig=function(t,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(r){return[2,e.RESManager.Instance.loadConfig(t,n)]})})},n.prototype.createGameScene=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},n.prototype.soundException=function(){var t=window.alert;window.alert=function(n){null!=n&&n.indexOf("sound")>-1?e.warn("声音解码失败"):t(n)}},n.prototype.customEXMLProcessor=function(){RES.processor.map("exml",new e.EXMLProcessor)},n}(eui.UILayer);e.EgMain=t,__reflect(t.prototype,"eg.EgMain")}(eg||(eg={}));var eg;!function(e){var t=function(){function e(){}return e.prototype.getTheme=function(e,t,n,r){function i(e){t.call(r,e)}function o(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),n.call(r))}"undefined"!=typeof generateEUI?egret.callLater(function(){t.call(r,generateEUI)},this):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),""!=e&&RES.getResByUrl(e,i,this,RES.ResourceItem.TYPE_TEXT))},e}();e.ThemeAdapter=t,__reflect(t.prototype,"eg.ThemeAdapter",["eui.IThemeAdapter"])}(eg||(eg={}));var eg;!function(e){var t=function(t){function n(){var n=t.call(this)||this;return n._isDispose=!1,n.height=e.Config.STAGE_H,n}return __extends(n,t),Object.defineProperty(n.prototype,"pageType",{get:function(){return e.UILayer.LAYER_WINDOW},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pageId",{get:function(){return-1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"content",{get:function(){return this},enumerable:!0,configurable:!0}),n.prototype.initUI=function(t){e.log(t)},n.prototype.pageData=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,Promise.resolve({})]})})},n.prototype.open=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(n){switch(n.label){case 0:return e.Loading.Instance.show(),[4,this.loadRes(this.resName)];case 1:return n.sent(),[4,this.pageData()];case 2:return t=n.sent(),[4,this.setPageSkin()];case 3:return n.sent(),e.Loading.Instance.hide(),this.initUI(t),this.enter(),this.loadRes(this.preNextResName),[2]}})})},n.prototype.loadRes=function(t){return __awaiter(this,void 0,void 0,function(){var n=this;return __generator(this,function(r){return[2,new Promise(function(r,i){function o(){a++,a==s&&(r(),e.log("资源加载完成:"+t))}var a=0,s=0;null!=t&&t.length>0?(s=t.length,e.QueueLoader.Instance.loadGroupArray(t,e.QueueLoader.MAX_PRIORITY,n,o)):r()})]})})},n.prototype.close=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.exit()];case 1:return e.sent(),this.dispose(),[2]}})})},n.prototype.enter=function(){},n.prototype.exit=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,Promise.resolve({})]})})},Object.defineProperty(n.prototype,"resName",{get:function(){return this._resName},set:function(e){this._resName=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"preNextResName",{get:function(){return null},enumerable:!0,configurable:!0}),n.prototype.dispose=function(){for(this._isDispose=!0,this.parent&&(this.parent.removeChild(this),e.EventDispatcher.Instance.dispatchEventWith(egret.Event.CLOSE)),this._extraData=null,this._upPageExtraData=null;this.numChildren>0;){var t=this.removeChildAt(0);egret.is(t,"eg.IDispose")&&t.dispose()}},Object.defineProperty(n.prototype,"pageSkinName",{get:function(){return this._skinName},enumerable:!0,configurable:!0}),n.prototype.setPageSkin=function(){var t=this;return new Promise(function(n,r){t.once(eui.UIEvent.COMPLETE,function(e){n()},t),""!=t.pageSkinName&&null!=t.pageSkinName?egret.superSetter(e.PageBase,t,"skinName",t.pageSkinName):n()})},Object.defineProperty(n.prototype,"pageName",{get:function(){return this.name},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"upPageName",{get:function(){return this._upPageName},set:function(e){this._upPageName=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"curPageExtraData",{get:function(){return this._extraData},set:function(e){this._extraData=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"upPageExtraData",{get:function(){return this._upPageExtraData},set:function(e){this._upPageExtraData=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"skinName",{get:function(){return this.pageSkinName},set:function(e){this._skinName=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isDispose",{get:function(){return this._isDispose},enumerable:!0,configurable:!0}),n}(eui.Component);e.PageBase=t,__reflect(t.prototype,"eg.PageBase",["eg.IPage","eg.IDispose"])}(eg||(eg={}));var eg;!function(e){var t=function(){function e(){this.layerNames=[e.LAYER_SCENCE,e.LAYER_FULL_SCREEN_WINDOW,e.LAYER_WINDOW,e.LAYER_TIPS_WINDOW,e.LAYER_TIPS_WINDOW_WORDS,e.LAYER_LOADING],this.layers={},this.layerContainer=new egret.Sprite}return Object.defineProperty(e,"Instance",{get:function(){return null==e._instance&&(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(e){this._stage=e;for(var t,n=0;n<this.layerNames.length;n++)t=new egret.Sprite,this.layers[this.layerNames[n]]=t,this.layerContainer.addChild(t);this._stage.addChild(this.layerContainer)},e.prototype.getLayerByType=function(e){return this.layers[e]},Object.defineProperty(e.prototype,"layerWindow",{get:function(){return this.getLayerByType(e.LAYER_WINDOW)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"layerTips",{get:function(){return this.getLayerByType(e.LAYER_TIPS_WINDOW)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"layerScence",{get:function(){return this.getLayerByType(e.LAYER_SCENCE)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"layerFullScreenWindow",{get:function(){return this.getLayerByType(e.LAYER_FULL_SCREEN_WINDOW)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"layerTipsWords",{get:function(){return this.getLayerByType(e.LAYER_TIPS_WINDOW_WORDS)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"layerLoading",{get:function(){return this.getLayerByType(e.LAYER_LOADING)},enumerable:!0,configurable:!0}),e.LAYER_SCENCE="scence",e.LAYER_FULL_SCREEN_WINDOW="full_screen_window",e.LAYER_WINDOW="window",e.LAYER_TIPS_WINDOW="tips_window",e.LAYER_TIPS_WINDOW_WORDS="tips_words",e.LAYER_LOADING="loading",e}();e.UILayer=t,__reflect(t.prototype,"eg.UILayer")}(eg||(eg={}));var eg;!function(e){var t=function(t){function n(){return t.call(this)||this}return __extends(n,t),Object.defineProperty(n.prototype,"languageId",{set:function(t){this.text=e.LanguageManager.Instance.getLanguage(t)},enumerable:!0,configurable:!0}),n.prototype.dispose=function(){},n}(eui.BitmapLabel);e.GBitmapLabel=t,__reflect(t.prototype,"eg.GBitmapLabel",["eg.IDispose"])}(eg||(eg={}));var eg;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.initUI(),t}return __extends(t,e),t.prototype.initUI=function(){this.addEventListener(eui.UIEvent.COMPLETE,this.onUIInitComplete,this)},t.prototype.onUIInitComplete=function(e){this.img.source=this.image},Object.defineProperty(t.prototype,"image",{get:function(){return this._image},set:function(e){this._image=e},enumerable:!0,configurable:!0}),t}(eui.Button);e.GButtion2=t,__reflect(t.prototype,"eg.GButtion2")}(eg||(eg={}));var eg;!function(e){var t=function(t){function n(){var n=t.call(this)||this;return e.log("GButton"),n}return __extends(n,t),n.prototype.buttonReleased=function(){if(e.log("onTap:"+this.name),e.Config.isAutoUploadPageData&&this.name){for(var t=this.parent;t;){if(t instanceof e.PageBase){e.log(t);break}t=t.parent}if(t){var n=t;e.ActLog.Instance.log({event_type:51,refer_page_name:n.upPageExtraData.upPageName,current_page_name:n.pageName,element_name:this.name})}}},Object.defineProperty(n.prototype,"enabled",{get:function(){return egret.superGetter(e.GButton,this,"enabled")},set:function(t){if(egret.superSetter(e.GButton,this,"enabled",t),t)this.filters=[];else{var n=[.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0],r=new egret.ColorMatrixFilter(n);this.filters=[r]}},enumerable:!0,configurable:!0}),n.prototype.getCurrentState=function(){var e=t.prototype.getCurrentState.call(this);return"down"==e?this.scaleX=this.scaleY=.9:this.scaleX=this.scaleY=1,e},n.prototype.partAdded=function(t,n){e.log(t)},n.prototype.childrenCreated=function(){},n.prototype.dispose=function(){e.log("GButtion dispose")},n}(eui.Button);e.GButton=t,__reflect(t.prototype,"eg.GButton",["eg.IDispose"])}(eg||(eg={}));var eg;!function(e){var t=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.dispose=function(){},t}(eui.Image);e.GImage=t,__reflect(t.prototype,"eg.GImage",["eg.IDispose"])}(eg||(eg={}));var eg;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.initUI(),e}return __extends(n,t),n.prototype.initUI=function(){this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this)},n.prototype.onTouchBegin=function(t){this.$stage.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),this.$stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.scaleX=this.scaleY=.9,e.log(this.width+"|"+this.height)},n.prototype.onStageTouchEnd=function(t){var n=t.$currentTarget;n.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),n.removeEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.scaleX=this.scaleY=1,e.log("onStageTouchEnd")},n.prototype.onTouchCancle=function(t){var n=t.$currentTarget;n.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),n.removeEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),e.log("onTouchCancle")},n}(eui.Image);e.GImageButton=t,__reflect(t.prototype,"eg.GImageButton")}(eg||(eg={}));var eg;!function(e){var t=function(t){function n(){return t.call(this)||this}return __extends(n,t),n.prototype.dispose=function(){},Object.defineProperty(n.prototype,"languageId",{set:function(t){this.text=e.LanguageManager.Instance.getLanguage(t)},enumerable:!0,configurable:!0}),n}(eui.Label);e.GLabel=t,__reflect(t.prototype,"eg.GLabel",["eg.IDispose"])}(eg||(eg={}));var eg;!function(e){var t=function(e){function t(t,n,r,i){return e.call(this,t,n,r,i)||this}return __extends(t,e),t}(egret.Event);e.Event=t,__reflect(t.prototype,"eg.Event")}(eg||(eg={}));var eg;!function(e){var t=function(e){function t(){return e.call(this)||this}return __extends(t,e),Object.defineProperty(t,"Instance",{get:function(){return null==t.instance&&(t.instance=new t),t.instance},enumerable:!0,configurable:!0}),t}(egret.EventDispatcher);e.EventDispatcher=t,__reflect(t.prototype,"eg.EventDispatcher")}(eg||(eg={}));var eg;!function(e){var t=function(){function t(){}return t.prototype.onLoadStart=function(t,n){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(r){return[2,new Promise(function(r,i){e.Config.isWxgame()?r():EXML.load(n.root+n.url,function(t,n){if("web"==egret.Capabilities.runtimeType)for(var i=t.prototype.__class__,o=i.split("."),a=o.length,s=window,u=0;a>u;u++){var c=o[u];null==s[c]&&(u!=a-1?s[c]={}:(e.log("注册exml到window:"+i),s[c]=t)),s=s[c]}r(t)},t)})]})})},t.prototype.onRemoveStart=function(e,t){return Promise.resolve()},t}();e.EXMLProcessor=t,__reflect(t.prototype,"eg.EXMLProcessor",["RES.processor.Processor"])}(eg||(eg={}));var eg;!function(e){var t=function(){function t(){this.resQueue=[],this.list=[],this.priority=t.MAX_PRIORITY,RES.setMaxLoadingThread(3)}return Object.defineProperty(t,"Instance",{get:function(){return null==t._instance&&(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t.prototype.loadArray=function(e,t,n,r,i,o,a){void 0===n&&(n=-1),void 0===r&&(r=null),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),RES.createGroup(e,t),this.loadGroup(e,n,r,i,o,a)},t.prototype.loadGroupArray=function(e,t,n,r,i,o){var a=this;void 0===t&&(t=-1),void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=null),void 0===o&&(o=null),e.forEach(function(e){a.loadGroup(e,t,n,r,i,o)})},t.prototype.loadGroup=function(n,r,i,o,a,s){void 0===r&&(r=-1),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),void 0===s&&(s=null);try{RES.getGroupByName(n),-1==r&&(r=this.priority--),e.log("新增加载列表:"+n);var u={name:n,priority:r,thisObject:i,onComplete:o,onProgress:a,onError:s};this.resQueue.push(u),this.state==t.LOADING&&this.loadResName==n&&(this.list.push(u),e.log("相同组后加入element:"+n+"|"+u.priority)),this.load()}catch(c){e.log(c.toString())}},t.prototype.load=function(){function n(n){var r=egret.getTimer();n.groupName==g&&(this.state=t.FREE,a(),c.list.forEach(function(t){t.onComplete&&t.onComplete.call(t.thisObject,u.name);var n=c.resQueue.indexOf(t);-1!=n&&c.resQueue.splice(n,1),e.log("加载完成element:"+t.name+"|"+t.priority+"耗时:"+r+"-"+p+"="+(r-p))}),c.load())}function r(e){e.groupName==g&&(a(),c.list.forEach(function(e){e.onError&&e.onError.call(e.thisObject)}))}function i(t){t.groupName==g&&(e.log("资源组:["+g+"]"+t.itemsLoaded+"/"+t.itemsTotal),c.list.forEach(function(e){e.onProgress&&e.onProgress.call(e.thisObject,{itemsLoaded:t.itemsLoaded,itemsTotal:t.itemsTotal})}))}function o(t){e.log(t.groupName+"|"+t.resItem.url)}function a(){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,n,c),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,r,c),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,i,c),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,c)}var s=this;if(this.state!=t.LOADING){this.resQueue.sort(function(e,t){return t.priority-e.priority});var u=this.resQueue.shift();if(null!=u){if(RES.isGroupLoaded(u.name))return e.log("已经加载过:"+u.name),void(u.onComplete&&u.onComplete.call(u.thisObject));var c=this;this.loadResName=u.name,this.state=t.LOADING,this.list.length=0,this.list.push(u),this.resQueue.forEach(function(t){t.name==u.name&&(s.list.push(t),e.log("查找相同组element:"+t.name+"|"+t.priority))}),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,n,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,r,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,i,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,this);var g=u.name,l=u.priority,p=egret.getTimer();e.log("加载中:"+g+"|"+l+"|开始时间:"+p),RES.loadGroup(g,l)}}},t.LOADING="loading",t.FREE="free",t.MAX_PRIORITY=1e4,t}();e.QueueLoader=t,__reflect(t.prototype,"eg.QueueLoader")}(eg||(eg={}));var eg;!function(e){var t=function(){function t(n,r){t.WX_ROOT=wx.env.USER_DATA_PATH+"/",this._remoteUrl=n,this._path=r,e.log("url:"+this._remoteUrl),this.fs=wx.getFileSystemManager()}return Object.defineProperty(t.prototype,"remoteUrl",{get:function(){return this._remoteUrl},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isRemotePath",{get:function(){return 0==this._remoteUrl.indexOf("http://")||0==this._remoteUrl.indexOf("https://")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"localPath",{get:function(){if(null==this._path){var n=void 0,r=this._remoteUrl.indexOf("resource/");-1!=r&&(n=t.CACHE_DIR+this._remoteUrl.substr(r+9),n=n.split("?")[0]),this._path=n}return e.log("localPath:"+this._path),this._path},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"prefixPath",{get:function(){return this.isRemotePath?t.WX_ROOT+this.localPath:this._remoteUrl},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){var t,n=this._remoteUrl.split("?")[1];return n&&(t=n.split("=")[1]),e.log("version:"+t),t},enumerable:!0,configurable:!0}),t.prototype.getDirList=function(){var e=this.localPath.split("/");return e.pop(),e},t.prototype.mkdir=function(){for(var n=this.getDirList(),r="",i=0;i<n.length;i++)r+=n[i]+"/",this.exists(r)||(this.fs.mkdirSync(t.WX_ROOT+r),e.log("mkdir:"+t.WX_ROOT+r))},t.prototype.exists=function(n){n=t.WX_ROOT+n;try{return this.fs.accessSync(n),e.log("exists1:"+n+" 存在"),!0}catch(r){return e.log("exists2:"+n+" 不存在"),!1}},t.prototype.writeText=function(t){this.mkdir(),this.fs.writeFile({filePath:this.prefixPath,data:t,encoding:"utf8",success:function(t){e.log("writeText success")}})},t.prototype.read=function(){var t=this;return new Promise(function(n,r){return __awaiter(t,void 0,void 0,function(){var t,r,i,o;return __generator(this,function(a){switch(a.label){case 0:switch(t=this.localPath.split("."),r=t[t.length-1],e.log("suffix:"+r),o=r){case"jpg":return[3,1];case"png":return[3,1];case"json":return[3,3];case"text":return[3,5]}return[3,7];case 1:return[4,this.readImage()];case 2:return i=a.sent(),[3,7];case 3:return[4,this.readText()];case 4:return i=a.sent(),i=JSON.parse(i),[3,7];case 5:return[4,this.readText()];case 6:return i=a.sent(),[3,7];case 7:return n(i),[2]}})})})},t.prototype.downloadFile=function(){var t=this;return new Promise(function(n,r){t.mkdir();var i=t.remoteUrl,o=t.prefixPath;wx.downloadFile({url:i,filePath:o,success:function(t){e.log("success"),n()},fail:function(t){e.log("fail"),r()}})})},t.prototype.readImage=function(){var t=this;return new Promise(function(n,r){var i=wx.createImage();i.onload=function(){var t=new egret.BitmapData(i),r=new egret.Texture;r._setBitmapData(t),e.log("readImage texture:"+r),setTimeout(function(){n(r)},0)},i.onerror=function(t){console.error(t),e.log("-----------------------"),r(t)},e.log("prefixPath:"+t.prefixPath),i.src=t.prefixPath})},t.prototype.readText=function(){var t=this;return new Promise(function(n,r){t.fs.readFile({filePath:t.prefixPath,encoding:"utf8",success:function(t){e.log("readText:"+t.data),n(t.data)},fail:function(t){e.log("readFile fail:"+t),r()}})})},t.CACHE_DIR="cache/",t}();e.WXFile=t,__reflect(t.prototype,"eg.WXFile")}(eg||(eg={}));var eg;!function(e){var t=function(){function e(){}return e}();e.WXFontProcessor=t,__reflect(t.prototype,"eg.WXFontProcessor")}(eg||(eg={}));var eg;!function(e){var t=function(){function t(){}return t.prototype.onLoadStart=function(t,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(r){switch(r.label){case 0:return e.log("host:"+t),e.log(n.root+"|"+n.url+"|"+n.name+"|"+n.type+"|"+n.crc32),[4,e.WXCacheManager.Instance.getRes(n.root+n.url)];case 1:return[2,r.sent()]}})})},t.prototype.onRemoveStart=function(e,t){var n=e.get(t);return n.dispose(),Promise.resolve()},t}();e.WXImageProcessor=t,__reflect(t.prototype,"eg.WXImageProcessor",["RES.processor.Processor"])}(eg||(eg={}));var eg;!function(e){var t=function(){function t(){}return t.prototype.onLoadStart=function(t,n){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(r){switch(r.label){case 0:return t=0==n.url.indexOf("http://")||0==n.url.indexOf("https://")?n.url:n.root+n.url,[4,e.WXCacheManager.Instance.getRes(t)];case 1:return[2,r.sent()]}})})},t.prototype.onRemoveStart=function(e,t){return Promise.resolve()},t}();e.WXJsonProcessor=t,__reflect(t.prototype,"eg.WXJsonProcessor",["RES.processor.Processor"])}(eg||(eg={}));var eg;!function(e){var t=function(){function t(){}return t.prototype.onLoadStart=function(t,n){return __awaiter(this,void 0,void 0,function(){var t,r,i,o,a,s,u,c,g;return __generator(this,function(l){switch(l.label){case 0:return t=n.root+n.url,[4,e.WXCacheManager.Instance.getRes(t)];case 1:return r=l.sent(),i=t.lastIndexOf("/"),-1!=i&&(o=t.substring(0,i+1)+r.file),[4,e.WXCacheManager.Instance.getRes(o)];case 2:a=l.sent(),s=r.frames,u=new egret.SpriteSheet(a);for(c in s)g=s[c],u.createTexture(c,g.x,g.y,g.w,g.h,g.offX,g.offY,g.sourceW,g.sourceH);return[2,u]}})})},t.prototype.getData=function(t,n,r,i){e.log(r+"|"+i);var o=t.get(n);return o?o.getTexture(i):(console.error("missing resource : "+r+"#"+i),null)},t.prototype.onRemoveStart=function(e,t){return Promise.resolve()},t}();e.WXSheetProcessor=t,__reflect(t.prototype,"eg.WXSheetProcessor",["RES.processor.Processor"])}(eg||(eg={}));var eg;!function(e){var t=function(){function e(){}return e.prototype.getAsset=function(e,t,n){function r(r){t.call(n,r,e)}if(RES.hasRes(e)){var i=RES.getRes(e);i?r(i):RES.getResAsync(e,r,this)}else RES.getResByUrl(e,r,this,RES.ResourceItem.TYPE_IMAGE)},e}();e.AssetAdapter=t,__reflect(t.prototype,"eg.AssetAdapter",["eui.IAssetAdapter"])}(eg||(eg={}));var eg;!function(e){var t=function(){function e(){}return e.prototype.onLoadStart=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.onRemoveStart=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();e.WXTextProcessor=t,__reflect(t.prototype,"eg.WXTextProcessor",["RES.processor.Processor"])}(eg||(eg={}));var eg;!function(e){var t=function(){function t(){this.ui=new e.LoadingSimpleUI,this.spr=new egret.Sprite}return Object.defineProperty(t,"Instance",{get:function(){return null==t.ins&&(t.ins=new t),t.ins},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loadingUI",{set:function(e){this.ui=e},enumerable:!0,configurable:!0}),t.prototype.show=function(t){void 0===t&&(t=""),e.log("loading show"),this.ui.show(t),e.UILayer.Instance.layerLoading.addChild(this.ui.content)},t.prototype.progress=function(e,t){this.ui.progress(e,t)},t.prototype.hide=function(){e.log("loading hide"),this.ui.hide()},t}();e.Loading=t,__reflect(t.prototype,"eg.Loading")}(eg||(eg={}));var eg;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.firstRadius=50,e.secondRadius=25,e.angle=30,e.thickness=5,e.frameRate=20,e.initUI(),e}return __extends(n,t),n.prototype.initUI=function(){this.frameTime=1e3/this.frameRate;var t=e.createRect(e.Config.STAGE_W,e.Config.STAGE_H,0,.7);t.touchEnabled=!0,this.addChild(t),this.firstPoints=[],this.secondPoints=[],this.num=360/this.angle;for(var n,r,i,o=0,a=0;a<this.num;a++)i=o*Math.PI/180,n=Math.cos(i)*this.firstRadius,r=Math.sin(i)*this.firstRadius,this.firstPoints[a]={x:n,y:r},n=Math.cos(i)*this.secondRadius,r=Math.sin(i)*this.secondRadius,this.secondPoints[a]={x:n,y:r},o+=this.angle;this.shape=new egret.Shape,this.shape.graphics.lineStyle(this.thickness,14211288);for(var s,u,a=0;a<this.num;a++)s=this.firstPoints[a],u=this.secondPoints[a],this.shape.graphics.moveTo(u.x,u.y),this.shape.graphics.lineTo(s.x,s.y);this.shape.graphics.endFill(),this.shape.x=e.Config.STAGE_W/2,this.shape.y=e.Config.STAGE_H/2,this.addChild(this.shape),this.ani_shape=new egret.Shape,this.ani_shape.x=e.Config.STAGE_W/2,this.ani_shape.y=e.Config.STAGE_H/2,this.ani_shape.graphics.lineStyle(this.thickness,8026746),this.addChild(this.ani_shape),this.tf_msg=e.createTxt("",0,e.Config.STAGE_H/2+70,e.Config.STAGE_W,50,24,16777215,egret.HorizontalAlign.CENTER),this.addChild(this.tf_msg)},Object.defineProperty(n.prototype,"content",{get:function(){return this},enumerable:!0,configurable:!0}),n.prototype.progress=function(e,t){},n.prototype.show=function(e){this.frameIndex=0,this.t1=egret.getTimer(),this.addEventListener(egret.Event.ENTER_FRAME,this.onFrame,this),this.showMsg(e)},n.prototype.showMsg=function(e){this.tf_msg.text=e},n.prototype.onFrame=function(e){var t=egret.getTimer();if(t-this.t1>this.frameTime){var n=this.frameIndex%this.num,r=this.firstPoints[n],i=this.secondPoints[n];this.ani_shape.graphics.clear(),this.ani_shape.graphics.lineStyle(this.thickness,3355443),this.ani_shape.graphics.moveTo(i.x,i.y),this.ani_shape.graphics.lineTo(r.x,r.y),this.ani_shape.graphics.endFill(),this.frameIndex++,this.t1=t}},n.prototype.hide=function(){this.dispose()},n.prototype.dispose=function(){this.parent&&this.parent.removeChild(this),this.removeEventListener(egret.Event.ENTER_FRAME,this.onFrame,this)},n}(egret.DisplayObjectContainer);e.LoadingSimpleUI=t,__reflect(t.prototype,"eg.LoadingSimpleUI",["eg.ILoadingUI","eg.IDisplayObject","eg.IDispose"])}(eg||(eg={}));var eg;!function(e){var t=function(){function t(){}return Object.defineProperty(t,"Instance",{get:function(){return null==t._instance&&(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"languageData",{set:function(e){this._data=e},enumerable:!0,configurable:!0}),t.prototype.getLanguage=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i;if(null==this._data?e.log("没有设置语言包数据"):i=this._data[t],i){if(n)for(var o=n.length,a=0;o>a;a++)i=i.replace("${"+a+"}",n[a])}else e.log("语言id:"+t+"不存在");return i},t}();e.LanguageManager=t,__reflect(t.prototype,"eg.LanguageManager")}(eg||(eg={}));var eg;!function(e){var t=function(){function t(){}return t.prototype.loadConfig=function(t,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(r){switch(r.label){case 0:return e.log("loadConfig:"+t+" resourceRoot:"+n),[4,RES.loadConfig(t,n)];case 1:return[2,r.sent()]}})})},Object.defineProperty(t,"Instance",{get:function(){return n},enumerable:!0,configurable:!0}),t}();e.RESManager=t,__reflect(t.prototype,"eg.RESManager");var n=new t}(eg||(eg={}));var eg;!function(e){var t=function(){function t(){this._dic={}}return Object.defineProperty(t,"Instance",{get:function(){return null==t.instance&&(t.instance,t.instance=new t),t.instance
},enumerable:!0,configurable:!0}),t.prototype.showUI=function(t){var n,r=typeof t;switch(e.log("type:"+r),r){case"function":n=new t;break;case"string":n=new(egret.getDefinitionByName(t));break;case"object":n=t}this.bindData(n),this.show(n),this.uploadPageData(n)},t.prototype.show=function(t){t.open();var n=t.pageType,r=e.UILayer.Instance.getLayerByType(n);r.addChild(t.content);var i=this._dic[t.pageType];i&&!i.isDispose&&i.close(),this._dic[t.pageType]=t},t.prototype.bindData=function(e){var t=this._dic[e.pageType];e.upPageExtraData=this.getPageExtraData(t)},t.prototype.getPageExtraData=function(e){var t=(e?e.curPageExtraData:{})||{};return t.upPageName=e?e.pageName:"",t},t.prototype.uploadPageData=function(t){var n=this._dic[t.pageType];null==n&&t.pageType==e.UILayer.LAYER_TIPS_WINDOW&&(n=this._dic[e.UILayer.LAYER_WINDOW]);var r=t.pageName,i=n?n.pageName:"";e.Config.isAutoUploadPageData&&r&&e.ActLog.Instance.log({event_type:50,refer_page_name:i,current_page_name:r})},t}();e.UIManager=t,__reflect(t.prototype,"eg.UIManager")}(eg||(eg={}));var eg;!function(e){var t=function(){function t(){this.resConfigPath="wx_version.json"}return Object.defineProperty(t,"Instance",{get:function(){return r},enumerable:!0,configurable:!0}),t.prototype.init=function(){var t=this;return new Promise(function(r,i){return __awaiter(t,void 0,void 0,function(){var t;return __generator(this,function(i){switch(i.label){case 0:return"wxgame"!=egret.Capabilities.runtimeType?[3,3]:(e.log("---------------------------启用wxgame缓存------------------------------"),this.wxResProcessor(),this.resFile=new e.WXFile("http://",e.WXFile.CACHE_DIR+this.resConfigPath),t=void 0,this.resFile.exists(this.resFile.localPath)?[4,this.resFile.read()]:[3,2]);case 1:t=i.sent(),i.label=2;case 2:n=t||{},i.label=3;case 3:return r(),[2]}})})})},t.prototype.wxResProcessor=function(){RES.processor.map("image",new e.WXImageProcessor),RES.processor.map("text",new e.WXTextProcessor),RES.processor.map("json",new e.WXJsonProcessor),RES.processor.map("sheet",new e.WXSheetProcessor)},t.prototype.getRes=function(t){var n=this;return new Promise(function(r,i){return __awaiter(n,void 0,void 0,function(){var n,i;return __generator(this,function(o){switch(o.label){case 0:return n=new e.WXFile(t),n.isRemotePath&&this.isUpdateFile(n)?(e.log("网络下载资源"),[4,n.downloadFile()]):[3,2];case 1:o.sent(),this.updateCacheConfig(n),o.label=2;case 2:return[4,n.read()];case 3:return i=o.sent(),r(i),[2]}})})})},t.prototype.isUpdateFile=function(t){return e.log("isUpdateFile:"+t.remoteUrl),!(t.exists(t.localPath)&&this.compareResVersion(t))},t.prototype.compareResVersion=function(t){var r=n?n[t.prefixPath]:void 0;return e.log("localVersion:"+r+" verson:"+t.version),r==t.version},t.prototype.updateCacheConfig=function(t){if(e.log("updateCacheConfig prefixPath:"+t.prefixPath+"-> version:"+t.version),t.version){n[t.prefixPath]=t.version;var r=JSON.stringify(n);e.log(r),this.resFile.writeText(r)}},t.prototype.clearCache=function(){},t}();e.WXCacheManager=t,__reflect(t.prototype,"eg.WXCacheManager");var n,r=new t}(eg||(eg={}));var eg;!function(e){var t=function(){function e(){}return e.prototype.init=function(){},Object.defineProperty(e,"Instance",{get:function(){return n},enumerable:!0,configurable:!0}),e}();e.WXFileManager=t,__reflect(t.prototype,"eg.WXFileManager");var n=new t}(eg||(eg={}));var eg;!function(e){var t=function(){function t(){}return Object.defineProperty(t,"Instance",{get:function(){return null==t._instance&&(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"logUrl",{set:function(e){this._logUrl=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"templateData",{set:function(e){this._templateData=JSON.stringify(e)},enumerable:!0,configurable:!0}),t.prototype.log=function(t){var n=JSON.parse(this._templateData),r=n.message_data[0];for(var i in t)r[i]=t[i];r.timestamp=Date.now(),e.post(this._logUrl,n,egret.HttpResponseType.TEXT,{"Content-Type":"application/json"})},t.prototype.sendLog=function(t){e.post(this._logUrl,t,egret.HttpResponseType.TEXT,{"Content-Type":"application/json"})},t.prototype.getMsgDate=function(e,t,n){void 0===n&&(n=null);var r={activity_id:6e5,user_id:[{type:2,value:e}],event_type:t,timestamp:Date.now(),id:"activity-log-id-json-1",activity_type:1,kv:n};return r},t}();e.ActLog=t,__reflect(t.prototype,"eg.ActLog")}(eg||(eg={}));var eg;!function(e){var t=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return null==e._instance&&(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{set:function(e){this._data=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"platform",{get:function(){return this._platform},set:function(e){this._platform=e},enumerable:!0,configurable:!0}),e.prototype.getGameAPI=function(e){return this.getDomain("game")+this.getAPI(e)},e.prototype.getWXAPI=function(e){return this.getDomain("wx")+this.getAPI(e)},e.prototype.getLogAPI=function(e){return this.getDomain("log")+this.getAPI(e)},e.prototype.getDomain=function(e){return this._data.domain.domain[this._platform][e]},e.prototype.getAPI=function(e){return this._data.domain.api[e]},Object.defineProperty(e.prototype,"languageData",{get:function(){return this._data.language},enumerable:!0,configurable:!0}),e}();e.Description=t,__reflect(t.prototype,"eg.Description")}(eg||(eg={}));var eg;!function(e){function t(e){var t=egret.getQualifiedClassName(e);return egret.getDefinitionByName(t)}e.getDefinition=t}(eg||(eg={}));var eg;!function(e){var t=function(){function t(e){var t=document.getElementById("gameDiv");this.element=document.createElement("img"),this.element.style.position="absolute",t.appendChild(this.element),this.show(e)}return t.prototype.addEvent=function(e){this.element.addEventListener("touchstart",this.onTouchstart,!1)},t.prototype.onTouchstart=function(t){e.log(t)},t.prototype.show=function(e){void 0===e&&(e=null),null!=e&&this._imgUrl!=e&&(this._imgUrl=e,this.element.src=e),this.element.style.display="inline"},t.prototype.setPosition=function(t,n,r,i){var o=document.body.clientWidth/e.Config.STAGE_W,a=document.body.clientHeight/e.Config.STAGE_H;e.log("wScale:"+o),e.log("hScale:"+a),this.element.style.width=r*o+"px",this.element.style.height=i*a+"px",this.element.style.left=t*o+"px",this.element.style.top=n*a+"px"},t.prototype.hide=function(e){void 0===e&&(e=!1),this.element.style.display="none",e&&this.dispose()},t.prototype.dispose=function(){this.element.parentNode.removeChild(this.element)},t.prototype.getElement=function(){return this.element},t}();e.HtmlImage=t,__reflect(t.prototype,"eg.HtmlImage",["eg.IDispose"])}(eg||(eg={}));var util;!function(e){var t=function(){function e(e){this._pageSize=e,this._curPage=1,this._items=[]}return Object.defineProperty(e.prototype,"items",{set:function(e){this._items=e,this._countPage=this.pageCount(this._items.length)},enumerable:!0,configurable:!0}),e.prototype.pageCount=function(e){var t;return e=Math.floor((e-1)/this._pageSize),t=1>e?1:e+1},e.prototype.getItemsByPage=function(e){var t=(e-1)*this._pageSize,n=this._items.length;return this._items.slice(t,Math.min(t+this._pageSize,n))},Object.defineProperty(e.prototype,"curPageItems",{get:function(){return this.getItemsByPage(this.curPage)},enumerable:!0,configurable:!0}),e.prototype.toPrePage=function(){this._curPage>1&&this._curPage--},e.prototype.toNextPage=function(){this._curPage=Math.min(this._curPage+1,this.countPage)},Object.defineProperty(e.prototype,"allLen",{get:function(){return null==this._items?0:this._items.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"countPage",{get:function(){return this._countPage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"curPage",{get:function(){return this._curPage},set:function(e){this._curPage=Math.max(1,e)},enumerable:!0,configurable:!0}),e.prototype.getPageByItem=function(e){var t=this._items.indexOf(e);return-1!=t?this.getPageByIndex(t):-1},e.prototype.getPageByIndex=function(e){return e>=0?this.pageCount(e+1):-1},e.prototype.setCurItem=function(e){return this._items&&e<this._items.length?(this._curPage=this.getPageByIndex(e),e-=(this._curPage-1)*this._pageSize,this._curIndex=e,!0):!1},Object.defineProperty(e.prototype,"isFirstPage",{get:function(){var e;return 1==this._curPage&&(e=!0),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEndPage",{get:function(){var e;return this._curPage==this.countPage&&(e=!0),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageStr",{get:function(){return this._curPage+"/"+this._countPage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageSize",{get:function(){return this._pageSize},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this._items=null},e}();e.Pagination=t,__reflect(t.prototype,"util.Pagination")}(util||(util={}));var eg;!function(e){function t(e,t){for(var n=e.x,r=e.y,i=!1,o=0,a=t.length,s=a-1;a>o;s=o,o++){var u=t[o].x,c=t[o].y,g=t[s].x,l=t[s].y;if(u===n&&c===r||g===n&&l===r)return"on";if(r>c&&l>=r||c>=r&&r>l){var p=u+(r-c)*(g-u)/(l-c);if(p===n)return"on";p>n&&(i=!i)}}return i?"in":"out"}e.rayCasting=t}(eg||(eg={}));var util;!function(e){var t=function(){function e(){this.count=0,this.timer=new egret.Timer(1e3)}return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.shakeObj=function(e,t,n,r){this.stop(),this.target=e,this.initX=e.x,this.initY=e.y,this.maxDis=r,this.count=t*n,this.rate=n,this.timer.delay=1e3/n,this.timer.repeatCount=this.count,this.timer.addEventListener(egret.TimerEvent.TIMER,this.shaking,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.shakeComplete,this),this.timer.reset(),this.timer.start()},e.prototype.shaking=function(){egret.Tween.removeTweens(this.target),this.target.x=this.initX-this.maxDis+Math.random()*this.maxDis*2,this.target.y=this.initY-this.maxDis+Math.random()*this.maxDis*2,egret.Tween.get(this.target).to({x:this.initX,y:this.initY},999/this.rate)},e.prototype.shakeComplete=function(){this.target&&(egret.Tween.removeTweens(this.target),this.target.x=this.initX,this.target.y=this.initY,this.target=null),this.timer.removeEventListener(egret.TimerEvent.TIMER,this.shaking,this),this.timer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.shakeComplete,this)},e.prototype.stop=function(){this.shakeComplete()},e}();e.ShakeTool=t,__reflect(t.prototype,"util.ShakeTool")}(util||(util={}));var eg;!function(e){var t=function(t){function n(e,n){void 0===e&&(e="sound_play_png"),void 0===n&&(n="sound_pause_png");var r=t.call(this)||this;return r._playResName=e,r._pauseResName=n,r.initUI(),r}return __extends(n,t),n.prototype.initUI=function(){this.icon=e.createBitmap(this._playResName),this.icon.anchorOffsetX=this.icon.width/2,this.icon.anchorOffsetY=this.icon.height/2,this.addChild(this.icon),this.change(e.SoundMgr.Instance.soundStatus),this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},n.prototype.onClick=function(t){e.SoundMgr.Instance.soundStatus=e.SoundMgr.Instance.soundStatus==e.SoundMgr.PLAY?e.SoundMgr.CLOSE:e.SoundMgr.PLAY,this.change(e.SoundMgr.Instance.soundStatus)},n.prototype.change=function(t){t==e.SoundMgr.PLAY?(this.icon.texture=RES.getRes(this._playResName),egret.Tween.get(this.icon,{loop:!0}).to({rotation:360},2e3)):(this.icon.texture=RES.getRes(this._pauseResName),egret.Tween.removeTweens(this.icon),this.icon.rotation=0)},n.prototype.dispose=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),egret.Tween.removeTweens(this.icon)},n}(egret.DisplayObjectContainer);e.SoundIcon=t,__reflect(t.prototype,"eg.SoundIcon",["eg.IDispose"])}(eg||(eg={}));var eg;!function(e){var t=function(){function e(){this.status=e.PLAY,this.isPause=!1}return Object.defineProperty(e,"Instance",{get:function(){return null==e._instance&&(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype.play=function(t,n){function r(t){o(),n==egret.Sound.MUSIC?u.status!=e.PLAY||u.isPause||(u.bgSoundChannel=a.play(0)):(egret.log("播放2"),a.play(0,1))}function i(e){o()}function o(){a.removeEventListener(egret.Event.COMPLETE,r,u),a.removeEventListener(egret.IOErrorEvent.IO_ERROR,i,u)}if(void 0===n&&(n=egret.Sound.EFFECT),this.status==e.CLOSE)return void egret.log("声音关闭状态");var a=new egret.Sound;if(a.type=n,n==egret.Sound.MUSIC){if(this.stopBackgroundSound(),this.backgroundSoundURL==t){var s=0;return this.bgSoundChannel&&(s=this.bgSoundChannel.position),void(this.bgSoundChannel=this.bgSound.play(s))}this.backgroundSoundURL=t,this.bgSound=a}a.load(t),a.addEventListener(egret.Event.COMPLETE,r,this),a.addEventListener(egret.IOErrorEvent.IO_ERROR,i,this);var u=this},e.prototype.stopBackgroundSound=function(){this.bgSoundChannel&&this.bgSoundChannel.stop()},Object.defineProperty(e.prototype,"soundStatus",{get:function(){return this.status},set:function(t){this.status=t,this.status==e.CLOSE?this.stopBackgroundSound():this.play(this.backgroundSoundURL,egret.Sound.MUSIC)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pause",{get:function(){return this.isPause},set:function(e){this.isPause=e},enumerable:!0,configurable:!0}),e.PLAY="play",e.CLOSE="close",e}();e.SoundMgr=t,__reflect(t.prototype,"eg.SoundMgr")}(eg||(eg={}));var eg;!function(e){function t(e){}function n(e){for(var t=(new egret.HtmlTextParser).parse(e),n=t.length,r=[],i=0;n>i;i++)for(var o=t[i],a=o.text,s=a.length,u=void 0,c=0;s>c;c++)u={text:a.charAt(c),style:o.style},r.push(u);return r}e.stringToArray=t,e.htmlStringToArray=n}(eg||(eg={}));var eg;!function(e){var t=function(t){function r(){var e=t.call(this)||this;return e.list=new Array,e.timer=new egret.Timer(100),e.timer.addEventListener(egret.TimerEvent.TIMER,e.onTimer,e),e.timer.start(),e}return __extends(r,t),Object.defineProperty(r,"Instance",{get:function(){return null==r.instance&&(r.instance=new r),r.instance},enumerable:!0,configurable:!0}),r.prototype.init=function(e){},r.prototype.addMsg=function(e){this.list.push(e)},r.prototype.onTimer=function(t){var n=this.list.shift();n&&(n.y=e.Config.STAGE_H/2,n.x=(e.Config.STAGE_W-n.width)/2,egret.Tween.get(n).wait(700).to({y:n.y-200,alpha:1},900).wait(0).call(this.onComplete,this,[n]),e.UILayer.Instance.layerTipsWords.addChild(n))},r.prototype.onComplete=function(e){e.parent.removeChild(e)},r.showMsg=function(e){var t=new n(e);r.Instance.addMsg(t)},r}(egret.Sprite);e.Tips=t,__reflect(t.prototype,"eg.Tips");var n=function(t){function n(n){var r=t.call(this)||this;return r.txt=new egret.TextField,r.txt.size=36,r.txt.textColor=16777215,r.txt.fontFamily="Microsoft YaHei,Arial",r.txt.textFlow=n,r.txt.x=5,r.txt.y=5,r.shape=e.createRoundRect(r.txt.textWidth+10,r.txt.height+10,0,1),r.addChild(r.shape),r.addChild(r.txt),r.cacheAsBitmap=!0,r}return __extends(n,t),n}(egret.Sprite);e.Msg=n,__reflect(n.prototype,"eg.Msg")}(eg||(eg={}));var eg;!function(e){function t(e){r()&&egret.log("[LOG]"+m++ +" >>> "+e)}function n(e){r()&&egret.log("[WARN]"+m++ +" >>> "+e)}function r(){return e.Config.showLog||1==parseInt(egret.getOption("debug"))}function i(e,t){return void 0===t&&(t=egret.HttpResponseType.TEXT),__awaiter(this,void 0,void 0,function(){return __generator(this,function(n){switch(n.label){case 0:return[4,a(e,egret.HttpMethod.GET,t)];case 1:return[2,n.sent()]}})})}function o(e,t,n,r){return void 0===n&&(n=egret.HttpResponseType.TEXT),__awaiter(this,void 0,void 0,function(){return __generator(this,function(i){switch(i.label){case 0:return r=r||{"Content-Type":"application/x-www-form-urlencoded"},[4,a(e,egret.HttpMethod.POST,n,t,r)];case 1:return[2,i.sent()]}})})}function a(t,n,r,i,o){return __awaiter(this,void 0,void 0,function(){var a=this;return __generator(this,function(u){return e.log("req >>> "+t),[2,new Promise(function(u,c){function g(n){if(clearTimeout(d),null==n?e.log("onGetProgress->onGetComplete"):e.log("onGetComplete"),h(),r==egret.HttpResponseType.TEXT)try{e.log("http数据:"+f.response);var i=void 0;""!=f.response&&null!=f.response&&(i=JSON.parse(f.response)),u(i)}catch(o){e.log("res <<< 接口数据json解析错误:"+o.toString()+" >>> url:"+t),c(o)}else u(f.response)}function l(t){e.log("progress:"+t.bytesLoaded+"/"+t.bytesTotal),t.bytesLoaded==t.bytesTotal&&(void 0==f.response||""==f.response?(e.log("启动延时执行onGetComplete(null)"),d=setTimeout(function(){g(null)},0)):g(null))}function p(n){e.log("res <<< 接口网络错误 req url:"+t),h(),c(n),e.EventDispatcher.Instance.dispatchEventWith(egret.IOErrorEvent.IO_ERROR)}function h(){f.removeEventListener(egret.Event.COMPLETE,g,this),f.removeEventListener(egret.ProgressEvent.PROGRESS,l,this),f.removeEventListener(egret.IOErrorEvent.IO_ERROR,p,this)}n==egret.HttpMethod.GET&&null!=i&&(t+="?"+i);var f=new egret.HttpRequest;f.withCredentials=!1,f.responseType=r,f.addEventListener(egret.Event.COMPLETE,g,a),f.addEventListener(egret.ProgressEvent.PROGRESS,l,a),f.addEventListener(egret.IOErrorEvent.IO_ERROR,p,a);var d;f.open(t,n);for(var _ in o)f.setRequestHeader(_,o[_]);n==egret.HttpMethod.POST&&null!=i?f.send(s(i,o["Content-Type"])):f.send()})]})})}function s(e,t){var n;if("text/json"==t)n=JSON.stringify(e);else if("application/octet-stream"==t)n=e;else if("application/json"==t)n=JSON.stringify(e);else{n="";for(var r in e)""!=n&&(n+="&"),n+=encodeURIComponent(r)+"="+encodeURIComponent(e[r])}return n}function u(t,n,r,i,o){void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=!1),void 0===o&&(o=!1);var a;return RES.hasRes(t)?(a=new egret.Bitmap(RES.getRes(t)),o&&(a.anchorOffsetX=a.width/2,a.anchorOffsetY=a.height/2),a.x=n,a.y=r,a.touchEnabled=i):e.log("资源不存在:"+t),a}function c(e,t){for(var n=t.length,r=0;n>r;r++)e.addChild(t[r])}function g(e,t,n,r,i){void 0===r&&(r=1),void 0===i&&(i=!1);var o=new egret.Shape;return o.graphics.beginFill(n,r),o.graphics.drawRect(0,0,e,t),o.graphics.endFill(),o.touchEnabled=i,o}function l(e,t,n,r,i,o,a,s,u,c,g){void 0===o&&(o=30),void 0===a&&(a=0),void 0===s&&(s=egret.HorizontalAlign.LEFT),void 0===u&&(u=!1),void 0===c&&(c=egret.VerticalAlign.MIDDLE),void 0===g&&(g="Microsoft YaHei,Arial");var l=new egret.TextField;return l.width=r,l.height=i,l.textAlign=s,l.verticalAlign=c,l.size=o,l.bold=u,l.textColor=a,l.text=e,l.x=t,l.y=n,l}function p(e,t,n,r,i,o,a,s,u){void 0===o&&(o=egret.HorizontalAlign.LEFT),void 0===a&&(a=!1),void 0===s&&(s=egret.VerticalAlign.MIDDLE),void 0===u&&(u="Microsoft YaHei,Arial");var c=new egret.TextField;return c.textAlign=o,c.verticalAlign=s,c.size=r,c.bold=a,c.textColor=i,c.text=e,c.x=t,c.y=n,c}function h(e,t,n){void 0===n&&(n=1);var r=new egret.Shape;return r.graphics.beginFill(t,n),r.graphics.drawCircle(0,0,e),r.graphics.endFill(),r}function f(e,t,n,r,i,o,a,s){void 0===r&&(r=1),void 0===i&&(i=15),void 0===o&&(o=15),void 0===a&&(a=0),void 0===s&&(s=0);var u=new egret.Shape;return u.graphics.beginFill(n,r),u.graphics.drawRoundRect(0,0,e,t,i,o),u.graphics.endFill(),u.x=a,u.y=s,u}function d(t){return/^data:image/.test(t)||(t="data:image/jpeg;base64,"+t),new Promise(function(n,r){e.log("createBitmapByBase64Image:"+t.length);var i=new Image;i.src=t,i.onload=function(){e.log("img.onload");var t=new egret.BitmapData(i),r=new egret.Texture;r.bitmapData=t;var o=new egret.Bitmap(r);n(o)},i.onerror=function(t){e.log("err:"+t.toString())}})}function _(e){for(var t=new Uint8Array(e.length),n=0,r=e.length;r>n;n++)t[n]=e.charCodeAt(n);return t}var m=0;e.log=t,e.warn=n,e.isDebug=r,e.get=i,e.post=o,e.request=a,e.formatReqParams=s,e.createBitmap=u,e.addChild=c,e.createRect=g,e.createTxt=l,e.createTxt2=p,e.createCircle=h,e.createRoundRect=f,e.createBitmapByBase64Image=d,e.utf2buffer=_}(eg||(eg={}));var eg;!function(e){var t=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return null==e._instance&&(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype.config=function(e,t,n){wx.config(e),wx.ready(function(){wx.hideOptionMenu(),wx.showMenuItems({menuList:["menuItem:share:appMessage","menuItem:share:timeline"]}),t.call(n)}),wx.error(function(){egret.log("config error")})},e.prototype.share=function(t,n,r,i){var o;switch(t){case e.SHARE_APPMESSAGE:o=wx.onMenuShareAppMessage;break;case e.SHARE_TIMELINE:o=wx.onMenuShareTimeline;break;case e.SHARE_QQ:o=wx.onMenuShareQQ;break;case e.SHARE_WEIBO:o=wx.onMenuShareWeibo}n.trigger=function(e){r("trigger",e)},n.success=function(e){r("success",e)},n.cancel=function(e){r("cancel",e)},n.fail=function(e){r("fail",e)},o(n)},e.SHARE_TIMELINE="onMenuShareTimeline",e.SHARE_APPMESSAGE="onMenuShareAppMessage",e.SHARE_QQ="onMenuShareQQ",e.SHARE_WEIBO="onMenuShareWeibo",e}();e.WXUtil=t,__reflect(t.prototype,"eg.WXUtil")}(eg||(eg={}));